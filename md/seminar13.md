## ペアリングと電子書籍

吉田 努  
  
白勢研ゼミ 2016/11/01  

<style type="text/css">
	.reveal table {
		font-size: 80%;
	}
</style>

<style type="text/css">
.reveal section img {
  margin: 15px 0px;
  border: 0px;
  box-shadow: 0 0 0px rgba(0, 0, 0, 0);
}
</style>

---
## 前回
- 前回の話題
- プロキシ暗号

---
## 今日の内容
- ペアリング
- 電子書籍
	- proxy re-encryptionによる電子書籍の貸出
	- LCP要件

---
## ペアリング
- 楕円曲線上で定義される双線形写像
- 双線形性
	- $e(aP, bQ) = e(P, Q)^{ab}$
	- 恐らくこれが一番重要

---
## ペアリングの種類(前回)
- $e'(aP, bP) = e(aP, \psi(bP))$ <!--' -->

1. type $I$
	- $e'(aP, bP) = e'(bP, aP)$ <!-- ' -->
	が成り立つ  <!--' -->
1. type $I\hspace{-.2em}I$
	- ディストーション写像は存在するが逆向きの写像を計算するのは困難
1. type $I\hspace{-.2em}I\hspace{-.2em}I$
	- ディストーション写像が存在しない

- type $I$は対称ペアリング, type$I\hspace{-.2em}I$, $I\hspace{-.2em}I\hspace{-.2em}I$は非対称ペアリングと呼ばれている

---
## Pairings for cryptographers
- Jouxがペアリングの走り
	- 3者DH鍵共有
- その後はIDベース系が流行
	- Short Signature(Bonehら)
	- IDベース暗号(笠原ら)
- pairingはblack box
	- タイプごとに様々な仮定について見ていく

--
## Pairings for cryptographers
- 概要
	- できるだけ数学的にならないようにペアリングの特性について解説している
	- ペアリングを使った暗号を設計するときに便利
	- 暗号を設計する際に用いられる仮定がtypeごとにことなる
		- homomorphism ($G_2 \to G_1$)
		- poly time generate
		- hash
		- short ○○?  
		など
- かなり有益
	- が、TEPLAがあるのであんまり関係なかった？
	- ペアリングのタイプがはっきりした

---
## Type of pairing
1. type $I$
	- $G_1 = G_2$
1. type $I\hspace{-.2em}I$
	- $G_1 \neq G_2$かつ$G_2$から$G_1$への凖同型写像が効率的に計算可能
1. type $I\hspace{-.2em}I\hspace{-.2em}I$
	- $G_1 \neq G_2$かつ凖同型写像が効率的に計算できない

--
## Type of pairing
- type $I$とtype $I\hspace{-.2em}I$は区別しない
	- $G_1 \neq G_2$だが凖同型写像が計算できる  
	$\rightarrow$type $I$に変換可能
- type 4があるらしい
	- $G_2$は位数$l^2$の群(巡回群ではない)

--
## 有益な表

---
## 安全性仮定は何だろう?
- 光成さんの本に何か乗ってた気がした  
↓

- IDベース暗号に関する調査報告書
	- CRYPTREC
	- IDベース暗号調査WG

---
## ペアリング逆関数問題
- $e(P, Q) = z$
1. FAPI-1 Problem: $P, z$が与えられたとき$Q$を求める
1. FAPI-2 Problem: $Q, z$が与えられたとき$P$を求める
1. GPI Problem: $z$が与えられたとき$P, Q$を求める

- 定理
	- FAPI-1とFAPI-2がともに効率的に解けるなら, $G_1, G_2, G_T$内においてCDH問題が効率的に解ける

- CDH(Computaional Diffie-Hellman)
	- $P, aP, bP$が与えられたとき$abP$を求める

---
## ペアリング逆関数問題に基づいた公開鍵暗号方式?
- 秘密鍵
	- $s \in \mathbb{Z}$
	- $t \in \mathbb{Z}$
	- $Q \in G_2$
- 公開鍵
	- $Q_s = sQ \in G_2$
	- $Q_t = tQ \in G_2$

--
- 暗号化
	- $P \in G_1$ (random)
	- $C_1 = m \times e(P, Q_s)$
	- $C_2 = e(P, Q_t)$
	- $C = (C_1, C_2)$
- 復号
	- $C_1 / (C_2)^\frac{s}{t}$  
	$= m \times e(P, sQ) / e(P, tQ)^{\frac{s}{t}}$  
	$= m \times e(P, Q)^s / e(P, Q)^s$  
	$= m$

--
## 議論
- IND-CCAとか難しい話はとりあえず置いておく
	- 公開鍵暗号の場合は致命傷になるがとりあえずは
- 公開鍵: $sQ, tQ$から秘密鍵$s, t, Q$は求まらないはず
	- $s/t$ももちろん求まらない
- $C_1 = m \times e(P, sQ)$は$m$倍されているため問題ない?
	- 攻撃者は$m$は分からない
- $C_2 = e(P, tQ)$と公開鍵$tQ$から$P$を求める
	- まさにFAPI-2

---
## 電子書籍

---
## EPUB LCP
- Electronic Publication Lightweight Content Protection
- IDPF(International Digital Publishing Forum)が規程した
	- 先生曰くw3cに移行予定?
- 2012年から議論が進んでいるのか疑問
- Light DRM
	- 軽量のDRM
	- そこまで厳しくユーザに制限を与えない
- Heavy DRM
	- 重いDRM
	- ユーザビリティや機能性よりもコンテンツ保護

---
## LCPの暗号に関する規程
- 最低一段階のファイルに対する暗号化は必要
	- おそらく共通鍵暗号をさしている
	- ここでは, 以降コンテンツ保護のための共通鍵をコンテンツキーと呼ぶ
- 最低AES 128bitを使え(つまり256でも可)
- コンテンツキーの暗号化に公開鍵暗号もほぼ必須扱い(RSA-1024ぐらい安価でECC-NIST-256くらい効率的なものが求められる)
- key hidingは実装者依存
- 鍵の失効はサポートされません

---
## 電子書籍の貸し借り(1/3)
- 昨年の外川氏の研究
	- 具体的なところは触れず
- とりあえず共有(貸出)を目指す
- LCPのユースケースではパスワードを渡すことで解決していた
	- 明らかにスマートではない
- 公開鍵暗号としてProxy re-encryptionを使えば一回の貸出が実現できる
	- 再暗号化された暗号文は, 通常の暗号文とは異なる
	- 再暗号化の再暗号化は不可能


---
## 電子書籍の貸し借り(2/3)
- 先行研究
	- google scholarにて'e-book lending'というキーワードで検索
	- interlibrary lendingにやたらヒット
		- 図書館の本の相互貸出
		- あまり読む気がしない
	- LCP要件だけでもいいかもしれない?
- 暗号よりとして持っていく?
	- ディジタルコンテンツの一回に制限した貸出手法?
	- すこし苦しいかもしれない


---
## 電子書籍の貸し借り(3/3)
- 課題: 相手の公開鍵が必要
	- IDベース化で名前のみで暗号化できるようにする
		- ユーザID or e-mailアドレス
	- 多分そんな論文があったはず
	- 一段落したら?

---
## KOBOの場合
- kepub
	- LCPに基づいた独自実装なはず(公開はされていない)
	- zipのバイナリが別々のユーザで一致
		- コンテンツキーはファイルごとに定まる!?
		- 一つのコンテンツキーが漏洩するとすべてバレる
		- どうせ一つ破られたら漏洩するからいいのかも?
			- AESが破られることは考え辛い
			- プログラム的に破られる

--
- ハックによる解読
	- 鍵を変えても無駄
	- 電子透かしの技術の信頼性はいかほどに?
- おそらくkepubは攻略されているはず
	- 昨年の研究によると
	- そう考えるととLCPってどうなの?

---
## 思いつき(タイムリリース暗号)
- 要するに時刻が正しいことを示す署名がその時刻に飛んでくる
- 公開鍵(検証鍵)は$sP, P$
	- セキュアチャネル?で配信(OSやブラウザやライブラリなど)
- 誰でも検証できるようになる
- かなり実用的なのでは？
	- デジタルコンテンツの事前配信
	- 少なくとも電子透かしのように実装から破られる恐れはない

---
## 今後の予定
- とりあえず進める
